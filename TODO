-Maybe this can be redesigned as part of a small text-processing language.
